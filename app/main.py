from fastapi import FastAPI
from starlette.middleware.cors import CORSMiddleware

from admin import adminModels, adminRoutes
from core.database import Base, engine
from users import userModels, userRoutes
from core import database
Base.metadata.create_all(bind=engine)


# –ú–µ—Ç–∞–¥–∞–Ω—ñ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó API
description = """
## üîê –°–µ—Ä–≤—ñ—Å –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏

–¶–µ–π API –Ω–∞–¥–∞—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ —Ç–∞ —ó—Ö –≥—Ä—É–ø–∞–º–∏.

### –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:

#### üë• –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (Users)
* –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
* –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥—Ä—É–ø–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
* –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ –≥—Ä—É–ø

#### üë®‚Äçüíº –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ (Admins)
* –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
* –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—è–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≥—Ä—É–ø–∞–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
* –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ –¥–æ –≥—Ä—É–ø –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
* –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≥—Ä—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∞–¥–º—ñ–Ω–æ–º
* –ü–µ—Ä–µ–≥–ª—è–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∞–¥–º—ñ–Ω—É —á–µ—Ä–µ–∑ –∫–µ—Ä–æ–≤–∞–Ω—ñ –≥—Ä—É–ø–∏

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:
* **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏** –º–æ–∂—É—Ç—å –Ω–∞–ª–µ–∂–∞—Ç–∏ –¥–æ **–≥—Ä—É–ø –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤** (–¥–ª—è –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó)
* **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º** –º–æ–∂–Ω–∞ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ **–≥—Ä—É–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è
* **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** –º–æ–∂—É—Ç—å –Ω–∞–ª–µ–∂–∞—Ç–∏ –¥–æ **–≥—Ä—É–ø –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**
* –ê–¥–º—ñ–Ω –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Ç–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –Ω–∞–ª–µ–∂–∞—Ç—å –¥–æ –≥—Ä—É–ø, —è–∫–∏–º–∏ –≤—ñ–Ω —É–ø—Ä–∞–≤–ª—è—î
"""

app = FastAPI(
    title="üîê Auth Service API",
    description=description,
    version="1.0.0",
    contact={
        "name": "API Support",
        "email": "support@authservice.com",
    },
    license_info={
        "name": "MIT",
    },
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:8000", "http://localhost:5173"],  # –∞–±–æ ["*"] –¥–ª—è –≤—Å—ñ—Ö
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

app.include_router(
    adminRoutes.router, 
    prefix="/api/admin", 
    tags=["üë®‚Äçüíº –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏"],
    responses={404: {"description": "–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ"}}
)
app.include_router(
    userRoutes.router, 
    prefix="/api/users", 
    tags=["üë• –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ"],
    responses={404: {"description": "–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ"}}
)

if __name__ == "__main__":
    import uvicorn
    uvicorn.run("main:app", host="0.0.0.0", port=8000, reload=True)
